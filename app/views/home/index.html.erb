<div class="prototype-track home-track">
  <section class="track-hero">
    <div class="track-hero__content">
      <p class="prototype-eyebrow"><%= raw SiteContent.get('hero_eyebrow', 'Loopgroep Virgil') %></p>
      <h1><%= raw SiteContent.get('hero_title', 'Tempo op de baan, focus op vooruitgang.') %></h1>
      <div class="hero-description">
        <%= raw SiteContent.get('hero_description', 'Een track-geïnspireerde coaching experience met dezelfde tools als je gewend bent: schema\'s, aanwezigheden en resultaten blijven exact werken zoals op de oude site.') %>
      </div>
      <div class="track-hero__ctas">
        <% if current_user %>
          <%= link_to 'Training deze week', user_schema_path(current_user, :dezeweek), class: 'app-btn track-btn--glow' %>
          <%= link_to 'Mijn schema', user_schema_path(current_user, :schema), class: 'app-btn app-btn--secondary track-btn--outline' %>
          <%= link_to 'Afmelden vandaag', vandaag_training_session_path, class: 'app-btn app-btn--secondary track-btn--outline' %>
        <% else %>
          <%= link_to 'Log in', login_path, class: 'app-btn track-btn--glow' %>
          <%= link_to 'Registreren', register_path, class: 'app-btn app-btn--secondary track-btn--outline' %>
          <%= link_to 'Intake', intake_path, class: 'app-btn app-btn--secondary track-btn--outline' %>
        <% end %>
      </div>
    </div>

    <div class="track-hero__visual home-track__visual">
      <% if current_user %>
        <span class="track-lap-counter">Welkom</span>
        <p><%= current_user.name %></p>
        <small>Je hebt <%= @upcoming_birthdays&.count || 0 %> verjaardagen in zicht</small>
      <% else %>
        <span class="track-lap-counter">02:47</span>
        <p>Pacing in progress</p>
        <small>Word lid van de loopgroep</small>
      <% end %>
    </div>
  </section>

  <section class="prototype-section track-metrics home-track-metrics">
    <article class="metric-card">
      <h3>Trainingen</h3>
      <p>Week 26–52</p>
      <span class="metric-label">27 weken</span>
    </article>
    <article class="metric-card">
      <h3>Trainers</h3>
      <p>Virgil & Danny</p>
      <span class="metric-label">2 hoofdcoaches</span>
    </article>
    <article class="metric-card">
      <h3>Fases</h3>
      <p>Zomer → Wedstrijd</p>
      <span class="metric-label">4 blokken</span>
    </article>
  </section>

  <% if @upcoming_public_sessions.present? %>
    <section class="prototype-section track-schedule">
      <header class="prototype-section__header">
        <h2>Groepstrainingen</h2>
      </header>
      <div class="track-schedule__grid">
        <% @upcoming_public_sessions.each do |session| %>
          <article class="track-session-card">
            <% formatted_date = begin
              I18n.l(session.date, format: :dutch_short, locale: :nl)
            rescue
              session.date&.strftime('%d %b')
            end %>
            <span class="track-session-card__date"><%= formatted_date %></span>
            <h3><%= session.description.presence || 'Training' %></h3>
            <p><%= session.loopscholing.presence || session.kern.presence || '' %></p>
            <div class="track-session-card__meta">
              <span class="badge badge-primary"><%= session.fase.presence || session.week %></span>
              <span class="track-session-card__trainer"><%= session.trainer&.name || session.trainer&.email || 'Trainer volgt' %></span>
            </div>
            <div class="track-session-card__actions">
              <%= link_to 'Bekijk details', training_session_path(session), class: 'app-btn app-btn--secondary track-btn--outline' %>
            </div>
          </article>
        <% end %>
      </div>
    </section>
  <% end %>

  <% if current_user && @tiles.present? %>
    <section class="prototype-section home-track-dashboard">
      <header class="prototype-section__header">
        <h2>Dashboard</h2>
      </header>
      <div class="home-track-dashboard__list">
        <% @tiles.each do |tile| %>
          <article class="home-track-dashboard__item theme-card">
            <div class="dashboard-item-content">
              <span class="home-track-dashboard__icon"><%= tile[:icon] %></span>
              <div>
                <h3><%= tile[:label] %></h3>
                <p><%= raw tile[:desc] %></p>
              </div>
            </div>
            <% if tile[:key] == 'birthdays_30' %>
              <%= link_to 'Verjaardagen', trainers_verjaardagen_path, class: 'app-btn app-btn--secondary track-btn--outline' %>
            <% else %>
              <%= link_to 'Open', tile[:url], class: 'app-btn track-btn--glow' %>
            <% end %>
          </article>
        <% end %>
      </div>
    </section>
  <% end %>

  <% if current_user&.role == 'admin' %>
    <section class="prototype-section home-track-admin">
      <div class="home-track-admin__card theme-card">
        <p class="prototype-eyebrow">Beheer</p>
        <h3>Admin dashboard</h3>
        <p>Alle bestaande beheerflows werken zoals altijd, nu met het nieuwe uiterlijk.</p>
        <%= link_to 'Ga naar admin', admin_path, class: 'app-btn track-btn--glow' %>
      </div>
    </section>
  <% end %>

  <% unless current_user %>
    <section class="prototype-section home-track-onboarding">
      <div class="onboarding-content">
        <h3>Nieuw bij de loopgroep?</h3>
        <p>Registreer je en krijg direct toegang tot schema's, aanwezigheden en community-updates.</p>
        <div class="track-hero__ctas">
          <%= link_to 'Registreren', register_path, class: 'app-btn track-btn--glow' %>
          <%= link_to 'Plan een kennismaking', schema_path, class: 'app-btn app-btn--secondary track-btn--outline' %>
        </div>
      </div>
    </section>
  <% end %>
</div>

<style>
/* Homepage specifieke styling met CSS-variabelen */
.home-track {
  background: var(--background-color);
}

.track-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 24px;
  max-width: 1200px;
  margin: 0 auto;
}

.track-metrics .metric-card {
  text-align: center;
}

.track-schedule__grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 24px;
}

.track-session-card {
  background: var(--background-color-card);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 24px;
  transition: all 0.2s ease;
}

.track-session-card:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  transform: translateY(-2px);
}

.track-session-card__date {
  display: inline-block;
  background: var(--accent-color);
  color: var(--text-color);
  padding: 4px 12px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 12px;
}

.track-session-card h3 {
  color: var(--text-color);
  font-size: 20px;
  margin-bottom: 12px;
}

.track-session-card p {
  color: var(--text-color-muted);
  font-size: 16px;
  margin-bottom: 16px;
}

.track-session-card__meta {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.track-session-card__trainer {
  color: var(--text-color-muted);
  font-size: 14px;
}

.track-session-card__actions {
  margin-top: 16px;
}

.home-track-dashboard__list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 24px;
}

.home-track-dashboard__item {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.dashboard-item-content {
  display: flex;
  gap: 16px;
  align-items: flex-start;
}

.home-track-dashboard__icon {
  font-size: 32px;
  flex-shrink: 0;
}

.home-track-dashboard__item h3 {
  margin-bottom: 8px;
  font-size: 20px;
}

.home-track-dashboard__item p {
  color: var(--text-color-muted);
  font-size: 16px;
  margin: 0;
}

.home-track-admin__card {
  text-align: center;
  max-width: 600px;
  margin: 0 auto;
}

.home-track-onboarding {
  text-align: center;
}

.onboarding-content {
  max-width: 700px;
  margin: 0 auto;
}

.onboarding-content h3 {
  font-size: 32px;
  margin-bottom: 16px;
}

.onboarding-content p {
  font-size: 20px;
  color: var(--text-color-muted);
  margin-bottom: 32px;
}

@media (max-width: 768px) {
  .track-metrics {
    grid-template-columns: 1fr;
  }
  
  .track-schedule__grid {
    grid-template-columns: 1fr;
  }
  
  .home-track-dashboard__list {
    grid-template-columns: 1fr;
  }
}
</style>
